<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>회원가입 - 상상 마루</title>
    <link rel="stylesheet" href="../css/globals.css" />
    <link rel="stylesheet" href="../css/variables.css" />
    <link rel="stylesheet" href="../css/common.css" />
    <link rel="stylesheet" href="../css/dropdown.css" />
    <link rel="stylesheet" href="../css/animations.css" />
    <link rel="stylesheet" href="signup.css" />
    <link rel="stylesheet" href="../css/responsive.css" />
    <script src="../js/api.js" defer></script>
  </head>
  <body>
    <div class="signup-page">
      <header class="nav-container">
        <nav class="nav-inner-container">
          <div class="nav-logo-box">
            <a href="../index.html"><img src="../img/logo.png" alt="상상 마루" class="nav-logo" /></a>
          </div>
          <ul class="navbar" role="menubar">
            <li class="div nav-item" role="menuitem">
              <a href="about/greeting.html">단체소개</a>
              <ul class="dropdown-menu">
                <li><a href="about/greeting.html">인사말</a></li>
                <li><a href="about/history.html">연혁</a></li>
                <li><a href="about/location.html">오시는 길</a></li>
              </ul>
            </li>
            <li class="div nav-item no-dropdown" role="menuitem">
              <a href="#">진로·직업체험</a>
            </li>
            <li class="div nav-item" role="menuitem">
              <a href="education/afterschool.html">교육활동</a>
              <ul class="dropdown-menu">
                <li><a href="education/afterschool.html">방과후/늘봄 교육</a></li>
                <li><a href="education/outside.html">학교밖 늘봄교육</a></li>
                <li><a href="education/freeyear.html">자유학년(기)제</a></li>
                <li><a href="education/drone.html">탑마루드론축구단</a></li>
                <li><a href="education/hrd.html">HRD-Net강사양성과정</a></li>
                <li><a href="education/volunteer.html">교육기부 진로체험</a></li>
              </ul>
            </li>
            <li class="div nav-item" role="menuitem">
              <a href="experience/creative.html">체험활동</a>
              <ul class="dropdown-menu">
                <li><a href="experience/creative.html">창의적체험활동</a></li>
                <li><a href="experience/swai.html">SW.AI교육주간</a></li>
                <li><a href="experience/science.html">과학의날 행사 지원</a></li>
                <li><a href="experience/culture.html">문화예술체험 교육</a></li>
              </ul>
            </li>
            <li class="div nav-item" role="menuitem">
              <a href="community/notice.html">커뮤니티</a>
              <ul class="dropdown-menu">
                <li><a href="community/notice.html">공지사항</a></li>
                <li><a href="community/press.html">보도자료</a></li>
                <li><a href="community/gallery.html">포토갤러리</a></li>
              </ul>
            </li>
            <li class="div nav-item no-dropdown" role="menuitem">
              <a href="store/store.html">스토어</a>
            </li>
          </ul>
          <div class="nav-button-box">
            <a href="login.html" class="nav-button" aria-label="로그인">
              <span class="text-wrapper-2">로그인</span>
            </a>
            <a href="signup.html" class="div-wrapper" aria-label="회원가입">
              <span class="text-wrapper-3">회원가입</span>
            </a>
          </div>
        </nav>
      </header>

      <main class="signup-content">
        <div class="signup-form-container">
          <div class="signup-header">
            <h1 class="signup-title">상상마루 회원가입</h1>
            <p class="signup-description">아이디와 비밀번호를 입력하여 회원가입을 진행해주세요.</p>
          </div>

          <form id="signup-form" class="signup-form">
            <div class="form-group">
              <label for="username" class="sr-only">아이디</label>
              <input
                type="text"
                id="username"
                name="username"
                class="form-input"
                placeholder="아이디 (2~50자)"
                required
                autocomplete="username"
                minlength="2"
                maxlength="50"
              />
              <small class="form-hint">영문, 숫자 조합 2~50자</small>
            </div>
            <div class="form-group">
              <label for="email" class="sr-only">이메일</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-input"
                placeholder="이메일 주소"
                required
                autocomplete="email"
              />
            </div>
            <div class="form-group">
              <label for="password" class="sr-only">비밀번호</label>
              <input
                type="password"
                id="password"
                name="password"
                class="form-input"
                placeholder="비밀번호 (8자 이상)"
                required
                autocomplete="new-password"
                minlength="8"
              />
              <small class="form-hint">영문, 숫자, 특수문자 포함 8자 이상</small>
            </div>
            <div class="form-group">
              <label for="password-confirm" class="sr-only">비밀번호 확인</label>
              <input
                type="password"
                id="password-confirm"
                name="password_confirm"
                class="form-input"
                placeholder="비밀번호 확인"
                required
                autocomplete="new-password"
                minlength="8"
              />
            </div>

            <div id="error-message" class="error-message"></div>

            <div class="form-actions">
              <button type="submit" class="btn-primary">회원가입</button>
              <a href="login.html" class="btn-secondary">이미 계정이 있으신가요? 로그인</a>
            </div>
          </form>
        </div>
      </main>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('signup-form');
        const errorMessage = document.getElementById('error-message');

        form.addEventListener('submit', async function(e) {
          e.preventDefault();

          const username = document.getElementById('username').value.trim();
          const email = document.getElementById('email').value.trim();
          const password = document.getElementById('password').value;
          const passwordConfirm = document.getElementById('password-confirm').value;

          errorMessage.textContent = '';
          errorMessage.style.display = 'none';

          // 비밀번호 확인
          if (password !== passwordConfirm) {
            errorMessage.textContent = '비밀번호가 일치하지 않습니다.';
            errorMessage.style.display = 'block';
            return;
          }

          try {
            const response = await AuthAPI.signup(username, email, password, passwordConfirm);

            if (response.success) {
              alert('회원가입이 완료되었습니다!');
              window.location.href = '../index.html';
            }
          } catch (error) {
            errorMessage.textContent = error.message || '회원가입에 실패했습니다.';
            errorMessage.style.display = 'block';
          }
        });
      });
    </script>
  </body>
</html>
